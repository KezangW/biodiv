<VirtualHost *:80>
    ProxyRequests Off
    ProxyPass /geoserver http://saturn.strandls.com:8080/geoserver
    ProxyPassReverse /geoserver http://saturn.strandls.com:8080/geoserver
    ServerName bhutanbiodiversity.localhost.org
    ServerAlias www.bhutanbiodiversity.localhost.org
    DocumentRoot /home/kinley/species
    DirectoryIndex index.php index.html index.html index.htm index.shtml
    ScriptAlias /cgi-bin/ /usr/lib/cgi-bin/


    RewriteEngine on

    RewriteCond %{REQUEST_URI} ^/biodiv/(static|plugins|data|bootstrap|js|css|j_spring_security_check|j_spring_openid_security_check|images|j_spring_security_logout|observation/upload_resource|emailConfirmation|ck).*
    RewriteRule ^/biodiv(.*)$ http://bhutanbiodiversity.localhost.org:8080/biodiv$1 [P]
    ProxyPassReverse /biodiv http://bhutanbiodiversity.localhost.org:8080/biodiv

    RewriteCond %{REQUEST_URI} ^/biodiv
    RewriteCond %{REQUEST_URI} !(^(/biodiv/(observations|newsletters|group-themes|users|userGroups|images|content)|(wgp_maps|geoserver)))
    RewriteRule ^/biodiv/(.*)$ /$1 [R=301,L]
    ProxyPassReverse / http://bhutanbiodiversity.localhost.org:8080/biodiv/

    RewriteCond %{REQUEST_URI} ^/.*
    RewriteCond %{REQUEST_URI} !(^(/biodiv))
    RewriteRule ^(.*)$ http://bhutanbiodiversity.localhost.org:8080/biodiv$1 [P,L]
    ProxyPassReverse / http://bhutanbiodiversity.localhost.org:8080/biodiv/
    ProxyPassReverse / http://bhutanbiodiversity.localhost.org:8080/


    ProxyPassReverseCookiePath /biodiv /

</VirtualHost>
