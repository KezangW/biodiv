<VirtualHost *:80>
    ProxyRequests Off
    ProxyPass /geoserver http://saturn.strandls.com:8080/geoserver
    ProxyPassReverse /geoserver http://saturn.strandls.com:8080/geoserver
    ServerName bhutanbiodiversity.localhost.org
    ServerAlias www.bhutanbiodiversity.localhost.org
    DocumentRoot /home/chokey/species
    DirectoryIndex index.php index.html index.html index.htm index.shtml
    ScriptAlias /cgi-bin/ /usr/lib/cgi-bin/


    RewriteEngine on

    RewriteCond %{REQUEST_URI} ^/bhutanbiodiv/(static|plugins|data|bootstrap|js|css|j_spring_security_check|j_spring_openid_security_check|images|j_spring_security_logout|observation/upload_resource|emailConfirmation|ck).*
    RewriteRule ^/bhutanbiodiv(.*)$ http://bhutanbiodiversity.localhost.org:8080/bhutanbiodiv$1 [P]
    ProxyPassReverse /bhutanbiodiv http://bhutanbiodiversity.localhost.org:8080/bhutanbiodiv

    RewriteCond %{REQUEST_URI} ^/bhutanbiodiv
    RewriteCond %{REQUEST_URI} !(^(/bhutanbiodiv/(observations|newsletters|group-themes|users|userGroups|images|content)|(wgp_maps|geoserver)))
    RewriteRule ^/bhutanbiodiv/(.*)$ /$1 [R=301,L]
    ProxyPassReverse / http://bhutanbiodiversity.localhost.org:8080/bhutanbiodiv/

#    RewriteCond %{REQUEST_URI} ^/(species|observation|activity|activityFeed|SUser|user|page|pages|requestMembership|joinUs|leaveUs|inviteMembers|login|logout|register|static|group|j_spring_security_logout|recommendation|comment|newsletter|emailConfirmation|search|checklist|jcaptcha|openId|data|chart|admin|curation|resource|rateable|rating|document|project|UFile|direction|bhutanbiodivAdmin).*
    RewriteCond %{REQUEST_URI} ^/.*
    RewriteCond %{REQUEST_URI} !(^(/bhutanbiodiv))
    RewriteRule ^(.*)$ http://bhutanbiodiversity.localhost.org:8080/bhutanbiodiv$1 [P,L]
    ProxyPassReverse / http://bhutanbiodiversity.localhost.org:8080/bhutanbiodiv/
    ProxyPassReverse / http://bhutanbiodiversity.localhost.org:8080/


    ProxyPassReverseCookiePath /bhutanbiodiv /

</VirtualHost>

